import csv
from collections import Counter
import re

# Corrected path to the extracted text file
input_txt_file = r'C:/Users/Dell/OneDrive\Desktop/HIT137/Assignment2/Hit137/extracted_texts.txt'

# Path for the output CSV file
output_csv_file = r'C:/Users/Dell/OneDrive/Desktop/HIT137/Assignment2/Hit137/top_30_words.csv'

# Open the text file and read its content
with open(input_txt_file, 'r', encoding='utf-8') as file:
    text = file.read()

# Tokenize the text into words (using regex to remove punctuation)
words = re.findall(r'\b\w+\b', text.lower())  # Extract words and convert to lowercase

# Count the occurrences of each word
word_counts = Counter(words)

# Get the 30 most common words
top_30_words = word_counts.most_common(30)

# Write the top 30 words and their counts to a CSV file
with open(output_csv_file, 'w', newline='', encoding='utf-8') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(['Word', 'Count'])  # Writing header
    writer.writerows(top_30_words)  # Writing the words and their counts

print(f"Top 30 words written to {output_csv_file}")
